{"version":3,"file":"contentScript.3b33971e434614315bff.hot-update.js","mappings":";;;;;;;;;;;;AACA;AACA;AAEA;AACA;AACA;AAAA;AADA;;AAKA;AAEA;;AAEA;AAEA;;AAEA;AAEA;AACA;AAEA;;AAEA;AAEA;AAEA;AACA;;AACA;AAEA;AAEA;AACA;AACA;AAGA;AACA;AACA;AAEA;AACA;AAEA;AACA;AAEA;;AAEA;AAEA;AAEA;;AAGA;AAEA;AACA;AAQA;AACA;AACA;AAEA;AACA;;AAEA;AAEA;AACA;AAAA;AAAA;AACA;;AACA;AACA;;AACA;;AACA;AAEA;AACA;AACA;AACA;AACA;;AAGA;AAEA;AACA;AACA;AACA;AACA;;;;;;;;ACpGA","sources":["webpack://visuability/./src/pages/Content/index.js","webpack://visuability/webpack/runtime/getFullHash"],"sourcesContent":["\nimport { ComputerVisionClient } from '@azure/cognitiveservices-computervision';\nimport { ApiKeyCredentials } from '@azure/ms-rest-js';\n\nconst computerVisionClient = new ComputerVisionClient(\n  new ApiKeyCredentials({ inHeader: \n    { 'Ocp-Apim-Subscription-Key': 'b2b0f47751494c8493d87044ce5cecb0' } }),\n      'https://visualbilty.cognitiveservices.azure.com/');\n\n//Get all images\nlet images = window.document.querySelectorAll(\"img\");\n\nconsole.log(images);\n\nfor(let i = 0; i < images.length; i++){\n    \n    var imgTag = images[i];\n\n    if(!imgTag.hasAttribute('alt') || !imgTag.alt)\n    {\n        recognizedImage(images[i]);\n    }\n    \n}\n\nfunction recognizedImage(imgTag) {\n\n    const url = imgTag.src;\n\n    computerVisionClient.describeImage(url)\n      .then(data => {\n            if(data.captions?.length > 0)\n            {\n                if(data.captions[0].text === 'text')\n                {\n                    //Need to call OCR API to recognize the text\n                    recognizedText(imgTag);\n                }\n                else\n                {\n                    //get display text\n                    console.log(data.captions[0].confidence);\n                    let altText = generateAltText(data.captions[0].text, data.captions[0].confidence);\n\n                    appendAlt(imgTag, altText);\n                }\n                \n            }\n        })\n      .catch(console.error);\n}\n\nfunction appendAlt(imgTag, altText) {\n\n  imgTag.alt = altText;\n\n}\n\n\nfunction generateAltText(data, confidence){\n\n  let ret = '';\n  if(confidence >= 0.40)\n    ret = data;\n  else if(confidence < 0.4 && confidence >= 0.2)\n    ret = \"It probability is \" + data;\n  else if(confidence < 0.2 && confidence >= 0.1)\n    ret = \"It likely is \" + data;\n  else\n  {\n    debugger;\n    ret = \"Image cannot be recogenized.\";\n  }\n\n  return ret;\n}\n\nfunction recognizedText(imgTag)\n{\n  var url = imgTag.src;\n  computerVisionClient.recognizePrintedText(true, url, { language:\"en\"})\n  .then((result) => {\n    if(result.regions?.length > 0)\n    {\n      let text = \"\";\n      if(result.regions[0].lines?.length > 0)\n      {\n        console.log(result.regions[0].lines[0].words);\n        result.regions[0].lines[0].words.forEach(element => {\n          console.log(element);\n          text += element.text + \" \";\n        });\n\n        //get display text\n        let altText = generateAltText(text, 1);\n\n        appendAlt(imgTag, altText);\n      }\n    }\n  });\n}","__webpack_require__.h = () => (\"c4c09f7ccce43608dfc7\")"],"names":[],"sourceRoot":""}