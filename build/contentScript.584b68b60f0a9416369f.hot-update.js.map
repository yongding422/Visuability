{"version":3,"file":"contentScript.584b68b60f0a9416369f.hot-update.js","mappings":";;;;;;;;;;;;AACA;AACA;AAEA;AACA;AACA;AAAA;AADA;;AAKA;;AAEA;AAEA;;AAEA;AAEA;AACA;AAEA;;AAEA;AAEA;AAEA;AACA;;AACA;AAEA;AAEA;AACA;AACA;;AAEA;AACA;AACA;AAEA;;AAEA;AAEA;AAEA;;AAIA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AACA;AACA;;AAEA;AAEA;AACA;AACA;;AACA;AACA;;AACA;;AACA;AAEA;AACA;AACA;AAEA;AACA;;AAEA;AACA;;AACA;AAEA;AACA;;AAEA;AACA;;;;;;;;ACvFA","sources":["webpack://visuability/./src/pages/Content/index.js","webpack://visuability/webpack/runtime/getFullHash"],"sourcesContent":["\nimport { ComputerVisionClient } from '@azure/cognitiveservices-computervision';\nimport { ApiKeyCredentials } from '@azure/ms-rest-js';\n\nconst computerVisionClient = new ComputerVisionClient(\n  new ApiKeyCredentials({ inHeader: \n    { 'Ocp-Apim-Subscription-Key': 'b2b0f47751494c8493d87044ce5cecb0' } }),\n      'https://visualbilty.cognitiveservices.azure.com/');\n\n//Get all images\nlet images = window.document.querySelectorAll(\"img\");\n\nfor(let i = 0; i < images.length; i++){\n    \n    var imgTag = images[i];\n\n    if(!imgTag.alt)\n    {\n        recognizedImage(images[i]);\n    }\n    \n}\n\nfunction recognizedImage(imgTag) {\n\n    const url = imgTag.src;\n\n    computerVisionClient.describeImage(url)\n      .then(data => {\n            if(data.captions?.length > 0)\n            {\n                if(data.captions[0].text === 'text')\n                {\n                    //Need to call OCR API to recognize the text\n                    recognizedText(imgTag);\n                }\n\n                appendAlt(imgTag, data);\n            }\n        })\n      .catch(console.error);\n}\n\nfunction appendAlt(imgTag, altText) {\n\n  imgTag.alt = generateAltText(altText);\n\n}\n\n\n\nfunction generateAltText(data){\n    let accurateDesc = result.description.captions.filter((val, index) => {\n    return val.confidence >= 0.8\n  })\n\n  if(!accurateDesc || accurateDesc.length === 0 ){\n    return\n  }\n  imgTag.alt = accurateDesc[0].text;\n}\n\nfunction recognizedText(imgTag)\n{\n  var url = imgTag.src;\n  computerVisionClient.recognizePrintedText(true, url)\n  .then((result) => {\n    if(result.regions?.length > 0)\n    {\n      let text = \"\";\n      if(result.regions[0].lines?.length > 0)\n      {\n        result.regions[0].lines[0].words.forEach(element => {\n          text += element.text + \" \";\n        });\n\n        imgTag.alt = generateAltText(text);\n      }\n      \n       result.regions[0]\n    }\n    console.log(text);\n\n    return text;\n  });\n  //Call OCR API\n  return result;\n}","__webpack_require__.h = () => (\"4ed16addd2428d022a2d\")"],"names":[],"sourceRoot":""}